<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConstelaÃ§Ã£o Familiar com Medicina do Cacau</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- BIBLIOTECAS PARA PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #1a1a1a;
            padding: 40px;
            font-family: 'Montserrat', sans-serif;
        }

        .slide {
            width: 960px;
            height: 540px;
            margin: 30px auto;
            background: linear-gradient(135deg, #4A1C1C 0%, #2D0F0F 50%, #1F0A0A 100%);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        /* Overlay escuro - ELEMENTO REAL ao invÃ©s de ::before */
        .slide-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.25) 100%);
            pointer-events: none;
            z-index: 0;
        }

        /* Elementos decorativos de canto */
        .corner-decoration {
            position: absolute;
            width: 120px;
            height: 120px;
            border: 1px solid rgba(212, 175, 55, 0.35);
            z-index: 1;
        }

        .corner-decoration.top-left {
            top: 30px;
            left: 30px;
            border-right: none;
            border-bottom: none;
        }

        .corner-decoration.top-right {
            top: 30px;
            right: 30px;
            border-left: none;
            border-bottom: none;
        }

        .corner-decoration.bottom-left {
            bottom: 30px;
            left: 30px;
            border-right: none;
            border-top: none;
        }

        .corner-decoration.bottom-right {
            bottom: 30px;
            right: 30px;
            border-left: none;
            border-top: none;
        }

        /* Diamante nos cantos - ELEMENTO REAL ao invÃ©s de ::after */
        .corner-diamond {
            position: absolute;
            width: 8px;
            height: 8px;
            background: rgba(212, 175, 55, 0.4);
            transform: rotate(45deg);
        }

        .corner-decoration.top-left .corner-diamond {
            top: -4px;
            left: -4px;
        }

        .corner-decoration.top-right .corner-diamond {
            top: -4px;
            right: -4px;
        }

        .corner-decoration.bottom-left .corner-diamond {
            bottom: -4px;
            left: -4px;
        }

        .corner-decoration.bottom-right .corner-diamond {
            bottom: -4px;
            right: -4px;
        }

        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-25deg);
            font-family: 'Cormorant Garamond', serif;
            font-size: 90px;
            font-weight: 300;
            font-style: italic;
            color: rgba(212, 175, 55, 0.04);
            letter-spacing: 15px;
            white-space: nowrap;
            pointer-events: none;
            z-index: 1;
        }

        .glow-accent {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.03) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        .glow-accent.top {
            top: -100px;
            right: -50px;
        }

        .glow-accent.bottom {
            bottom: -100px;
            left: -50px;
        }

        .gold-line {
            width: 100px;
            height: 1px;
            background: linear-gradient(90deg, transparent, #D4AF37, transparent);
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }

        .gold-line.long {
            width: 200px;
        }

        .title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 44px;
            font-weight: 400;
            color: #D4AF37;
            text-align: center;
            letter-spacing: 3px;
            line-height: 1.3;
            position: relative;
            z-index: 2;
        }

        .subtitle {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 400;
            color: rgba(212, 175, 55, 0.85);
            text-align: center;
            letter-spacing: 4px;
            text-transform: uppercase;
            margin-top: 15px;
            position: relative;
            z-index: 2;
        }

        .section-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 38px;
            font-weight: 400;
            color: #D4AF37;
            text-align: center;
            letter-spacing: 2px;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .section-subtitle {
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            font-weight: 400;
            color: rgba(212, 175, 55, 0.65);
            text-align: center;
            letter-spacing: 6px;
            text-transform: uppercase;
            margin-bottom: 40px;
            position: relative;
            z-index: 2;
        }

        .content-list {
            list-style: none;
            text-align: left;
            max-width: 620px;
            position: relative;
            z-index: 2;
        }

        .content-list li {
            font-family: 'Montserrat', sans-serif;
            font-size: 17px;
            font-weight: 400;
            color: #FAF0E6;
            margin: 20px 0;
            padding-left: 30px;
            position: relative;
            line-height: 1.7;
        }

        /* Bullet point - ELEMENTO REAL */
        .bullet {
            position: absolute;
            left: 0;
            top: 6px;
            color: #D4AF37;
            font-size: 9px;
        }

        .content-list li strong {
            color: #E8C547;
            font-weight: 500;
        }

        .content-list li em {
            color: rgba(250, 240, 230, 0.8);
            font-style: italic;
        }

        .quote {
            font-family: 'Cormorant Garamond', serif;
            font-size: 26px;
            font-weight: 400;
            font-style: italic;
            color: #FAF0E6;
            text-align: center;
            max-width: 700px;
            line-height: 1.7;
            position: relative;
            z-index: 2;
        }

        .quote-mark {
            font-size: 60px;
            color: rgba(212, 175, 55, 0.4);
            font-family: 'Cormorant Garamond', serif;
            line-height: 0;
        }

        .closing-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 34px;
            font-weight: 400;
            color: #D4AF37;
            text-align: center;
            line-height: 1.8;
            position: relative;
            z-index: 2;
        }

        .closing-text em {
            color: #E8C547;
        }

        .author-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 30px;
            font-weight: 400;
            font-style: italic;
            color: #D4AF37;
            text-align: center;
            letter-spacing: 3px;
            margin-top: 10px;
            position: relative;
            z-index: 2;
        }

        .slide-number {
            position: absolute;
            bottom: 25px;
            right: 40px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 14px;
            color: rgba(212, 175, 55, 0.5);
            letter-spacing: 2px;
            z-index: 2;
        }

        .copyright {
            position: absolute;
            bottom: 14px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Montserrat', sans-serif;
            font-size: 9px;
            font-weight: 400;
            color: rgba(212, 175, 55, 0.45);
            letter-spacing: 2px;
            text-transform: uppercase;
            white-space: nowrap;
            z-index: 2;
        }

        .decorative-element {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 25px 0;
            position: relative;
            z-index: 2;
        }

        .decorative-element .dot {
            width: 7px;
            height: 7px;
            background: #D4AF37;
            transform: rotate(45deg);
        }

        .decorative-element .line {
            width: 60px;
            height: 1px;
            background: rgba(212, 175, 55, 0.5);
        }

        .side-accent {
            position: absolute;
            width: 1px;
            height: 80px;
            background: linear-gradient(180deg, transparent, rgba(212, 175, 55, 0.2), transparent);
            z-index: 1;
        }

        .side-accent.left {
            left: 60px;
            top: 50%;
            transform: translateY(-50%);
        }

        .side-accent.right {
            right: 60px;
            top: 50%;
            transform: translateY(-50%);
        }

        .slide-label {
            position: absolute;
            top: -25px;
            left: 0;
            font-size: 12px;
            color: #666;
            font-family: 'Montserrat', sans-serif;
        }

        .slide-wrapper {
            position: relative;
        }

        /* BOTÃƒO EXPORTAR */
        .export-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #D4AF37 0%, #C5A028 100%);
            color: #1F0A0A;
            border: none;
            padding: 16px 32px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 6px 25px rgba(212, 175, 55, 0.5);
            font-size: 14px;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(212, 175, 55, 0.6);
        }

        .export-btn:disabled {
            opacity: 0.7;
            cursor: wait;
        }

        /* BARRA DE PROGRESSO */
        .progress-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
            background: rgba(0,0,0,0.9);
            padding: 15px 20px;
            border-radius: 8px;
            display: none;
            min-width: 220px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .progress-text {
            color: #D4AF37;
            font-family: 'Montserrat', sans-serif;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(212, 175, 55, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #D4AF37, #E8C547);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <!-- BOTÃƒO EXPORTAR PDF -->
    <button class="export-btn" onclick="exportarPDF()">
        ðŸ“„ EXPORTAR PDF
    </button>

    <!-- BARRA DE PROGRESSO -->
    <div class="progress-container" id="progressContainer">
        <div class="progress-text" id="progressText">Preparando...</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <!-- SLIDE 1 - CAPA -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 1 - Capa</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <span class="watermark">Carol Costa</span>
            
            <div class="decorative-element">
                <span class="line"></span>
                <span class="dot"></span>
                <span class="line"></span>
            </div>
            
            <h1 class="title">ConstelaÃ§Ã£o Familiar<br>com a Medicina do Cacau</h1>
            
            <div class="gold-line long"></div>
            
            <p class="subtitle">PreparaÃ§Ã£o para o Atendimento</p>
            
            <div class="decorative-element">
                <span class="line"></span>
                <span class="dot"></span>
                <span class="line"></span>
            </div>

            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SLIDE 2 - ANTES DO ATENDIMENTO -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 2 - Antes do Atendimento</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <div class="side-accent left"></div>
            <div class="side-accent right"></div>
            <span class="watermark">Carol Costa</span>
            
            <h2 class="section-title">Antes do Atendimento</h2>
            <p class="section-subtitle">AlimentaÃ§Ã£o e Cuidados</p>
            
            <ul class="content-list">
                <li><span class="bullet">â—†</span>Jejum mÃ­nimo de <strong>3 horas</strong></li>
                <li><span class="bullet">â—†</span><strong>Sem Ã¡lcool</strong> nas 24 horas anteriores</li>
                <li><span class="bullet">â—†</span>Evitar excesso de <strong>cafeÃ­na</strong> no dia</li>
                <li><span class="bullet">â—†</span>RefeiÃ§Ã£o leve antes do jejum â€” <em>comida de verdade, nada pesado ou industrializado</em></li>
            </ul>
            
            <span class="slide-number">01</span>
            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SLIDE 3 - SONO E DESCANSO -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 3 - Sono e Descanso</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <div class="side-accent left"></div>
            <div class="side-accent right"></div>
            <span class="watermark">Carol Costa</span>
            
            <h2 class="section-title">Sono e Descanso</h2>
            <p class="section-subtitle">Prepare seu corpo para a vivÃªncia</p>
            
            <ul class="content-list">
                <li><span class="bullet">â—†</span>Priorize uma <strong>boa noite de sono</strong></li>
                <li><span class="bullet">â—†</span>ChÃ¡ de <strong>camomila</strong> antes de dormir para acalmar o sistema nervoso</li>
                <li><span class="bullet">â—†</span>Evite <strong>telas, discussÃµes</strong> ou estÃ­mulos intensos na noite anterior</li>
            </ul>
            
            <span class="slide-number">02</span>
            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SLIDE 4 - CORPO E MENTE -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 4 - Corpo e Mente</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <div class="side-accent left"></div>
            <div class="side-accent right"></div>
            <span class="watermark">Carol Costa</span>
            
            <h2 class="section-title">Corpo e Mente</h2>
            <p class="section-subtitle">No dia do atendimento</p>
            
            <ul class="content-list">
                <li><span class="bullet">â—†</span>Venha com roupas <strong>confortÃ¡veis</strong></li>
                <li><span class="bullet">â—†</span><strong>Hidrate-se</strong> bem ao longo do dia</li>
                <li><span class="bullet">â—†</span>Chegue <strong>alguns minutos antes</strong> para desacelerar</li>
                <li><span class="bullet">â—†</span>Traga <strong>papel e caneta</strong> se desejar anotar apÃ³s a vivÃªncia</li>
            </ul>
            
            <span class="slide-number">03</span>
            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SLIDE 5 - POSTURA INTERNA -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 5 - Postura Interna</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <div class="side-accent left"></div>
            <div class="side-accent right"></div>
            <span class="watermark">Carol Costa</span>
            
            <h2 class="section-title">Postura Interna</h2>
            <p class="section-subtitle">Como se preparar emocionalmente</p>
            
            <ul class="content-list">
                <li><span class="bullet">â—†</span>Venha com <strong>abertura</strong>, sem expectativas rÃ­gidas</li>
                <li><span class="bullet">â—†</span><strong>ConfianÃ§a</strong> no processo e respeito aos seus prÃ³prios limites</li>
            </ul>
            
            <div class="gold-line" style="margin: 30px 0;"></div>
            
            <p class="quote">
                <span class="quote-mark">"</span><br>
                NÃ£o Ã© sobre entender tudo com a mente, Ã© sobre permitir que o corpo e o campo mostrem o que precisa ser visto.
            </p>
            
            <span class="slide-number">04</span>
            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SLIDE 6 - ENCERRAMENTO -->
    <div class="slide-wrapper">
        <span class="slide-label">Slide 6 - Encerramento</span>
        <div class="slide">
            <div class="slide-overlay"></div>
            <div class="corner-decoration top-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration top-right"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-left"><span class="corner-diamond"></span></div>
            <div class="corner-decoration bottom-right"><span class="corner-diamond"></span></div>
            <div class="glow-accent top"></div>
            <div class="glow-accent bottom"></div>
            <span class="watermark">Carol Costa</span>
            
            <div class="decorative-element">
                <span class="line"></span>
                <span class="dot"></span>
                <span class="line"></span>
            </div>
            
            <p class="closing-text">
                Confie no processo.<br>
                <em>Seu corpo sabe o caminho.</em>
            </p>
            
            <div class="gold-line long" style="margin: 40px 0;"></div>
            
            <p class="author-name">Carol Costa</p>
            
            <div class="decorative-element">
                <span class="line"></span>
                <span class="dot"></span>
                <span class="line"></span>
            </div>
            
            <span class="slide-number">05</span>
            <span class="copyright">Â© 2025 Todos os direitos reservados</span>
        </div>
    </div>

    <!-- SCRIPT DE EXPORTAÃ‡ÃƒO CORRIGIDO -->
    <script>
        // Espera tudo carregar
        window.onload = function() {
            console.log('PÃ¡gina carregada - pronto para exportar');
        };

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function exportarPDF() {
            const btn = document.querySelector('.export-btn');
            const progressContainer = document.getElementById('progressContainer');
            const progressText = document.getElementById('progressText');
            const progressFill = document.getElementById('progressFill');
            
            // Desabilita botÃ£o e mostra progresso
            btn.disabled = true;
            btn.textContent = 'â³ Aguarde...';
            progressContainer.style.display = 'block';
            progressText.textContent = 'Preparando...';
            
            // Esconde labels
            document.querySelectorAll('.slide-label').forEach(el => {
                el.style.display = 'none';
            });

            // Aguarda um pouco para garantir renderizaÃ§Ã£o
            await delay(500);

            // Pega todos os slides
            const slides = document.querySelectorAll('.slide');
            const totalSlides = slides.length;
            
            // Cria o PDF
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF({
                orientation: 'landscape',
                unit: 'px',
                format: [960, 540],
                hotfixes: ['px_scaling']
            });

            try {
                for (let i = 0; i < totalSlides; i++) {
                    // Atualiza progresso
                    const percent = Math.round(((i + 0.5) / totalSlides) * 100);
                    progressText.textContent = `Capturando slide ${i + 1} de ${totalSlides}...`;
                    progressFill.style.width = percent + '%';
                    
                    // Aguarda um pouco antes de cada captura
                    await delay(300);
                    
                    // Captura o slide com configuraÃ§Ãµes seguras
                    const canvas = await html2canvas(slides[i], {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#2D0F0F',
                        logging: false,
                        width: 960,
                        height: 540,
                        onclone: function(clonedDoc) {
                            // Garante que o clone estÃ¡ visÃ­vel
                            const clonedSlide = clonedDoc.querySelectorAll('.slide')[i];
                            if (clonedSlide) {
                                clonedSlide.style.margin = '0';
                                clonedSlide.style.boxShadow = 'none';
                            }
                        }
                    });
                    
                    // Verifica se o canvas Ã© vÃ¡lido
                    if (canvas.width === 0 || canvas.height === 0) {
                        throw new Error('Canvas vazio no slide ' + (i + 1));
                    }
                    
                    // Adiciona ao PDF
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    
                    if (i > 0) {
                        pdf.addPage([960, 540], 'landscape');
                    }
                    
                    pdf.addImage(imgData, 'JPEG', 0, 0, 960, 540);
                    
                    // Atualiza progresso
                    const percentFinal = Math.round(((i + 1) / totalSlides) * 100);
                    progressFill.style.width = percentFinal + '%';
                }
                
                // Salva o PDF
                progressText.textContent = 'Gerando arquivo...';
                await delay(200);
                
                pdf.save('Carol_Costa_Constelacao_Cacau.pdf');
                
                // Sucesso
                btn.textContent = 'âœ… PDF Salvo!';
                progressText.textContent = 'Download concluÃ­do!';
                progressFill.style.width = '100%';
                
                setTimeout(() => {
                    btn.textContent = 'ðŸ“„ EXPORTAR PDF';
                    btn.disabled = false;
                    progressContainer.style.display = 'none';
                    progressFill.style.width = '0%';
                }, 3000);
                
            } catch (error) {
                console.error('Erro detalhado:', error);
                btn.textContent = 'âŒ Erro';
                progressText.textContent = 'Erro: ' + error.message;
                
                setTimeout(() => {
                    btn.textContent = 'ðŸ“„ EXPORTAR PDF';
                    btn.disabled = false;
                    progressContainer.style.display = 'none';
                }, 5000);
            }

            // Mostra labels novamente
            document.querySelectorAll('.slide-label').forEach(el => {
                el.style.display = 'block';
            });
        }
    </script>

</body>
</html>
